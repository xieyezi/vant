import{u as _,b as k,V as A}from"./index.f299ce25.js";import{c as I,O as N,n as D,r as F,Q as $,a as q}from"./use-translate.8036e41d.js";import{c as z,m as H,t as M,w as O}from"./with-install.6887218d.js";import{u as Q}from"./use-expose.1f17c8d6.js";import{L as Z}from"./index.e68b0dfb.js";import{A as P,x as p,y as E,Z as j,N as G,e as a,q as J,o as g,c as x,w as f,C as n,a as C,b as B,F as L}from"./vue-libs.a040eeb8.js";import{V as R}from"./index.e17d8230.js";import{V as K}from"./index.2c43eca6.js";import"./use-id.3079e917.js";import"./use-route.f2a7e4c6.js";import"./index.867f8025.js";import"./use-touch.ee9512d6.js";import"./on-popup-reopen.2164636b.js";import"./constant.80c6de18.js";import"./interceptor.66b82326.js";import"./use-refs.91bd8378.js";import"./index.6ff4f0d9.js";import"./index.bbaa83e9.js";const[W,h,X]=I("list"),Y={error:Boolean,offset:z(300),loading:Boolean,finished:Boolean,errorText:String,direction:H("down"),loadingText:String,finishedText:String,immediateCheck:M},ee=P({name:W,props:Y,emits:["load","update:error","update:loading"],setup(i,{emit:l,slots:t}){const s=p(!1),c=p(),u=p(),e=_(),r=N(c),d=()=>{J(()=>{if(s.value||i.finished||i.error||(e==null?void 0:e.value)===!1)return;const{offset:o,direction:v}=i,m=F(r);if(!m.height||$(c))return;let T=!1;const b=F(u);v==="up"?T=m.top-b.top<=o:T=b.bottom-m.bottom<=o,T&&(s.value=!0,l("update:loading",!0),l("load"))})},U=()=>{if(i.finished){const o=t.finished?t.finished():i.finishedText;if(o)return a("div",{class:h("finished-text")},[o])}},w=()=>{l("update:error",!1),d()},y=()=>{if(i.error){const o=t.error?t.error():i.errorText;if(o)return a("div",{role:"button",class:h("error-text"),tabindex:0,onClick:w},[o])}},S=()=>{if(s.value&&!i.finished)return a("div",{class:h("loading")},[t.loading?t.loading():a(Z,{class:h("loading-icon")},{default:()=>[i.loadingText||X("loading")]})])};return E(()=>[i.loading,i.finished,i.error],d),e&&E(e,o=>{o&&d()}),j(()=>{s.value=i.loading}),G(()=>{i.immediateCheck&&d()}),Q({check:d}),D("scroll",d,{target:r,passive:!0}),()=>{var m;const o=(m=t.default)==null?void 0:m.call(t),v=a("div",{ref:u,class:h("placeholder")},null);return a("div",{ref:c,role:"feed",class:h(),"aria-busy":s.value},[i.direction==="down"?o:v,S(),U(),y(),i.direction==="up"?o:v])}}}),te=O(ee),V=te,ke=P({__name:"index",setup(i){const l=q({"zh-CN":{errorInfo:"\u9519\u8BEF\u63D0\u793A",errorText:"\u8BF7\u6C42\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u65B0\u52A0\u8F7D",pullRefresh:"\u4E0B\u62C9\u5237\u65B0",finishedText:"\u6CA1\u6709\u66F4\u591A\u4E86"},"en-US":{errorInfo:"Error Info",errorText:"Request failed. Click to reload",pullRefresh:"PullRefresh",finishedText:"Finished"}}),t=p([{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1}]),s=u=>{const e=t.value[u];e.loading=!0,setTimeout(()=>{e.refreshing&&(e.items=[],e.refreshing=!1);for(let r=0;r<10;r++){const d=e.items.length+1;e.items.push(d<10?"0"+d:String(d))}e.loading=!1,e.refreshing=!1,u===1&&e.items.length===10&&!e.error?e.error=!0:e.error=!1,e.items.length>=40&&(e.finished=!0)},1e3)},c=u=>{t.value[u].finished=!1,s(u)};return(u,e)=>(g(),x(n(A),null,{default:f(()=>[a(n(k),{title:n(l)("basicUsage")},{default:f(()=>[a(n(V),{loading:t.value[0].loading,"onUpdate:loading":e[0]||(e[0]=r=>t.value[0].loading=r),finished:t.value[0].finished,"finished-text":n(l)("finishedText"),onLoad:e[1]||(e[1]=r=>s(0))},{default:f(()=>[(g(!0),C(L,null,B(t.value[0].items,r=>(g(),x(n(R),{key:r,title:r},null,8,["title"]))),128))]),_:1},8,["loading","finished","finished-text"])]),_:1},8,["title"]),a(n(k),{title:n(l)("errorInfo")},{default:f(()=>[a(n(V),{loading:t.value[1].loading,"onUpdate:loading":e[2]||(e[2]=r=>t.value[1].loading=r),error:t.value[1].error,"onUpdate:error":e[3]||(e[3]=r=>t.value[1].error=r),finished:t.value[1].finished,"error-text":n(l)("errorText"),onLoad:e[4]||(e[4]=r=>s(1))},{default:f(()=>[(g(!0),C(L,null,B(t.value[1].items,r=>(g(),x(n(R),{key:r,title:r},null,8,["title"]))),128))]),_:1},8,["loading","error","finished","error-text"])]),_:1},8,["title"]),a(n(k),{title:n(l)("pullRefresh")},{default:f(()=>[a(n(K),{modelValue:t.value[2].refreshing,"onUpdate:modelValue":e[7]||(e[7]=r=>t.value[2].refreshing=r),onRefresh:e[8]||(e[8]=r=>c(2))},{default:f(()=>[a(n(V),{loading:t.value[2].loading,"onUpdate:loading":e[5]||(e[5]=r=>t.value[2].loading=r),finished:t.value[2].finished,"finished-text":n(l)("finishedText"),onLoad:e[6]||(e[6]=r=>s(2))},{default:f(()=>[(g(!0),C(L,null,B(t.value[2].items,r=>(g(),x(n(R),{key:r,title:r},null,8,["title"]))),128))]),_:1},8,["loading","finished","finished-text"])]),_:1},8,["modelValue"])]),_:1},8,["title"])]),_:1}))}});export{ke as default};
